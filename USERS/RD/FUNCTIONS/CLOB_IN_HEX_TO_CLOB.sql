CREATE OR REPLACE
FUNCTION CLOB_IN_HEX_TO_CLOB(gCLOB IN CLOB)
RETURN CLOB
DETERMINISTIC PARALLEL_ENABLE
AS
    
    PRAGMA UDF;
    
    cData CLOB := EMPTY_CLOB();
    nLength SIMPLE_INTEGER := COALESCE
    (
        DBMS_LOB.GetLength(gCLOB),
        0
    );
    nCurrentPlace SIMPLE_INTEGER := 1;
    -- these pieces will make up the entire CLOB
    vPiece VARCHAR2(2000 BYTE) := NULL;
    
BEGIN
    
    IF nLength = 0 THEN
        
        RETURN NULL;
        
    END IF;
    
    DBMS_LOB.CreateTemporary
    (
        lob_loc => cData,
        cache => TRUE,
        dur => DBMS_LOB.CALL
    );
    
    DBMS_LOB.Open
    (
        cData,
        DBMS_LOB.LOB_READWRITE
    );
    
    LOOP
        -- get the next piece and add it to the clob
        vPiece := UTL_RAW.Cast_To_VarChar2
        (
            HEXTORAW
            (
                DBMS_LOB.SubStr(gCLOB, 2000, nCurrentPlace)
            )
        );
        
        -- append this piece to the CLOB
        DBMS_LOB.WriteAppend
        (
            cData,
            LENGTH(vPiece),
            vPiece
        );
        
        nCurrentPlace := nCurrentPlace + 2000;
        
        EXIT WHEN nLength < nCurrentPlace;
        
    END LOOP;
    
    RETURN cData;
    
END;
/

/*
--test
SET SERVEROUTPUT ON;

SELECT CLOB_IN_HEX_TO_CLOB('424547494E3A56434152440A56455253494F4E3A332E300A4E3A3B3B3B3B0A464E3A57686974652048617274204C616E6520436F6D6D756E6974792053706F7274732043656E7472650A4F52473A57686974652048617274204C616E6520436F6D6D756E6974792053706F7274732043656E7472653B0A54454C3B747970653D574F524B3A2B3434203230203838383120323332330A54454C3B747970653D574F524B3B747970653D4641583A2B3434203230203838383120383938330A454D41494C3B747970653D494E5445524E45543B747970653D484F4D453A61637469766540686172696E6765792E676F762E756B0A6974656D312E4144523B747970653D484F4D453A3B3B57686974652048617274204C616E653B4C6F6E646F6E3B3B4E3232203551573B556E69746564204B696E67646F6D0A6974656D312E582D41424144523A756B0A454E443A5643415244') AS CLOB$Data_,
CLOB_IN_HEX_TO_CLOB('696D6167652F6A706567')
FROM DUAL;
*/